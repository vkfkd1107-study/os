# 컴퓨터가 파일들을 보조저장장치에 저장하고 관리하는 방법
---

## 파일 기본 동작
    - 파일 생성, 쓰기, 읽기, 재배치, 삭제
    - 운영체제는 파일을 파일정보(파일 제어 블록)를 시스템 메모리의 파일 테이블에 복사해서 빠르게 접근할 수 있게 준비함

## 데이터 저장 방식(할당 방법): 데이터를 디스크에 물리적으로 배치하는 방식
    - 연속할당: 디스크에 연속적인 하나의 큰 블록으로 저장
        - 파일 크기가 변하면 공간을 찾기가 어렵거나 외부 단편화(자투리 공간 발생)가 심해져 잘 사용되지 않음
    - 연결할당: 디스크의 여러 분산 블록에 저장하고, 각 블록이 다음 블록의 위치를 가르킴
        - 외부 단편화 문제는 없지만, 파일의 특정 위치에 바로 접근하는게 어려움
        - MS-DOS, FAT 파일 시스템에서 사용
    - 색인할당: 모든 데이터 블록 위치를 **색인블록** 이라는 공간에 모아두는 방식
        - 색인블록으로 파일의 어떤 부분이라도 빠르게 찾을 수 있어 직접 접근에 효율적
        - UNIX inode

## 빈 공간 관리: 파일 시스템은 디스크의 어느 부분이 비어있고 사용 가능한지 추적해야함
    - 비트맵: 디스크의 각 블록에 0(빈 공간) 또는 1(사용 중)로 표시하는 비트를 사용
    - 연결 리스트 및 그룹화: 빈 블록들을 서로 연결하여 리스트로 관리하거나, 여러 빈 블록의 주소를 한 번에 묶어서 저장하여 빠르게 찾을 수 있게 함

## 성능 및 효율성: 디스크는 컴퓨터에서 가장 느린 부품 중 하나이므로, 파일 시스템의 성능 최적화가 중요함
    - 캐싱: 자주 접근하는 파일 데이터나 정보를 **메모리(캐시)**에 임시로 저장하여 디스크 접근을 줄이고 속도를 높임
    - 쓰기 방식: 데이터를 디스크에 쓰는 방법은 동기, 비동기가 있는데 대부분의 쓰기 작업은 빠른 비동기 방식을 사용
        - 동기: 디스크에 쓸때까지 기다림
        - 비동기: 메모리에만 저장하고 나중에 디스크에 씀

## 파일 시스템 복구: 시스템 충돌 등으로 파일 시스템에 문제가 발생했을때 데이터를 보호하고 복구하는 기능
    - 스냅샷: 파일 시스템의 특정 시점 상태를 저장하는 기능
        - 데이터를 수정할 때 기존 블록을 덮어쓰지 않고 새로운 블록에 저장
        - 필요할 때 특정 시점으로 되돌리수 있다
        - NetApp의 WAFL(Write-Anywhere File Layout) 파일 시스템, Apple APFS(Apple File System) 등에서 사용

## 정리
- 파일 시스템은 디스크에 파일을 어떻게 저장(할당방법)할건지, 어떤 공간이 비었는지 알고(빈 공간 관리) 빠르게 접근하게 돕고(성능), 문제가 생겼을때 이전 상태로 돌아갈 수 있게(복구) 해주는 관리자
