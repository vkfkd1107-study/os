# CPU 스케줄링
> - CPU가 여러 프로세스를 언제, 어떻게 실행할지 결정하는 정책
> - 프로세스는 많지만 CPU는 한정되어 있기 때문에 공정하고 효율적으로 CPU를 분배해야함

<br/>
<br/>

## 선점 및 비선점 스케줄링

| 구분  | 선점(Preemptive)                             | 비선점(Non-Preemptive)                  |
| --- | ------------------------------------------ | ------------------------------------ |
| 정의  | 실행 중인 프로세스를 강제로 멈추고 다른 프로세스에게 CPU를 넘길 수 있음 | 일단 실행되면 프로세스가 자발적으로 CPU를 반납할 때까지 기다림 |
| 제어권 | 운영체제(OS)가 CPU 제어권을 가져갈 수 있음                | 프로세스가 스스로 끝내거나 I/O 요청해야 교체 가능        |
| 특징  | 빠른 응답성, 공정함, 복잡한 스케줄링                      | 단순, 예측 가능, 비응답성 이슈                   |
| 예시  | 긴 작업 도중에도 더 중요한 작업이 오면 중간에 뺏음              | 작업이 끝나기 전까지는 아무도 못 들어감               |

- 비선점형은 단순하지만 응답성이 낮음 (초기 운영체제에 주로 사용)
- 선점형은 효율적이고 반응성이 좋지만 Cntext switching 이 많아짐


<br/>
<br/>

## 대표적인 CPU 스케줄링 알고리즘

### FCFS (First-Come, First-Served)
- 프로세스가 도착한 순서대로 CPU를 할당
- 구현은 단순하지만, 긴 작업이 뒤의 작업들을 오래 기다리게 할 수 있음
  
<br/>

### SJF (Shortest Job First)
- 실행 시간이 짧은 작업부터 먼저 처리
- 실제 실행 시간을 미리 알기 어려우며, 짧은 작업 위주라서 긴 작업이 계속 밀릴 위험이 있음

<br/>

### RR (Round Robin)
- 각 프로세스에 시간 조각(Time slice)을 나눠주고, 시간이 만료되면 다음 프로세스로 전환
- 공정하고 간단함
- 하지만 타임슬라이스가 너무 크면 FCFS처럼 되고, 너무 작으면 Context 스위칭이 많아져 비효율적일 수 있음

  <br/>


### Priority
- 우선순위가 높은 프로세스를 먼저 실행
- 우선순위가 낮은 프로세스는 계속 밀릴 수 있음
	- 해결방법 : Aging (대기시간이 길어지면 우선순위를 상승시킴)

 <br/>

### Multilevel Queue
- 프로세스들을 성격(대화형, 시스템, 실시간 프로세스 등)에 따라 여러 큐로 나누고
  각각 다르게 스케줄링
  
<br/>


  
### Multilevel Feedback Queue
- 여러 개의 큐를 만들고 프로세스의 실행시간/CPU 사용 패턴에 따라 큐를 바꾸며 
  유동적으로 스케줄링
- 처음엔 빠른 응답을 기대하고 높은 우선순위 큐로 나누지만 CPU를 너무 오래 쓰면
  낮은 우선순위 큐로 강등시키고, 기다리는 시간이 긴 프로세스를 순위를 올려주는 방식
- 다양한 작업을 특성이 맞게 대응할 수 있음
- 구현이 복잡하고 잘못 설계하면 오히려 성능 악화

  <br/>



### 각 스케줄링 알고리즘별 선점 여부

| 알고리즘                                | 선점 여부                   | 설명                                               |
| ----------------------------------- | ----------------------- | ------------------------------------------------ |
| **FCFS (First-Come, First-Served)** | ❌ 비선점                   | 먼저 온 프로세스가 끝날 때까지 CPU 사용                         |
| **SJF (Shortest Job First)**        | ❌ 비선점<br>(단, 선점형 변형 있음) | 실행 시간 가장 짧은 작업 먼저 실행 (선점형이면 짧은 작업이 새로 오면 바꿈)     |
| **Priority Scheduling**             | ⭕ 또는 ❌                  | 선점형: 더 높은 우선순위가 오면 바꿈<br>비선점형: 현재 작업이 끝날 때까지 기다림 |
| **Round Robin**                     | ⭕ 선점                    | 시간 조각(Time quantum) 초과하면 CPU 강제로 넘김              |
| **Multilevel Queue**                | ❌ 또는 ⭕ (정책에 따라 다름)      | 보통 큐 간 선점은 안 하지만, 큐 내부는 RR처럼 선점 사용 가능            |
| **Multilevel Feedback Queue**       | ⭕ 선점                    | 프로세스 행동에 따라 큐 이동 가능하므로 반드시 선점 필요                 |
